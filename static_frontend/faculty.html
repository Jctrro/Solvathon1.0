<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StudySync — Faculty Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
        href="https://fonts.googleapis.com/css2?family=Syne:wght@600;700;800&family=DM+Sans:wght@300;400;500&display=swap"
        rel="stylesheet" />

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { display: ['Syne', 'sans-serif'], body: ['DM Sans', 'sans-serif'] },
                    colors: {
                        bg: '#0B0B0F',
                        sidebar: '#0e0e18',
                        card: '#12121e',
                        card2: '#181828',
                        accent: '#8B5CF6',
                        accent2: '#7c3aed',
                        accent3: '#A78BFA',
                        pink: '#EC4899',
                        cyan: '#06B6D4',
                    },
                },
            },
        };
    </script>

    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html,
        body {
            height: 100%;
            font-family: 'DM Sans', sans-serif;
            background: #0B0B0F;
            color: #f0eaff;
            overflow: hidden;
        }

        ::-webkit-scrollbar {
            width: 5px;
            height: 5px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #2d2b45;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #8B5CF6;
        }

        /* ── Utilities ── */
        .text-gradient {
            background: linear-gradient(135deg, #A78BFA, #EC4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .shadow-glow {
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.25);
        }

        .shadow-glow2 {
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.4);
        }

        .sidebar-glow {
            box-shadow: inset -1px 0 0 rgba(139, 92, 246, 0.15), 4px 0 24px rgba(0, 0, 0, 0.4);
        }

        /* ── Shimmer ── */
        .shimmer {
            background: linear-gradient(90deg, #141420 25%, #1a1a2e 50%, #141420 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: 16px;
        }

        @keyframes shimmer {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }

        /* ── Modal ── */
        .modal-backdrop {
            animation: fadeIn 0.2s ease;
        }

        .modal-box {
            animation: slideUp 0.25s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: scale(0.96) translateY(10px);
            }

            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* ── Timetable ── */
        .timetable th {
            background: rgba(139, 92, 246, 0.08);
            color: #A78BFA;
            font-family: 'Syne', sans-serif;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid rgba(139, 92, 246, 0.15);
        }

        .timetable td {
            padding: 12px 16px;
            font-size: 13px;
            color: #c4b5fd;
            border-bottom: 1px solid rgba(139, 92, 246, 0.08);
            transition: background 0.15s;
        }

        .timetable tr:hover td {
            background: rgba(139, 92, 246, 0.05);
        }

        .timetable tr.today-row td {
            background: rgba(139, 92, 246, 0.08);
            border-left: 3px solid #8B5CF6;
        }

        /* ── Chart bars ── */
        .bar-wrap {
            display: flex;
            align-items: flex-end;
            gap: 6px;
        }

        .bar-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            flex: 1;
        }

        .bar-inner {
            display: flex;
            gap: 3px;
            align-items: flex-end;
            width: 100%;
            justify-content: center;
        }

        .bar {
            border-radius: 4px 4px 0 0;
            transition: height 0.7s ease;
            min-width: 14px;
            max-width: 22px;
            cursor: pointer;
            position: relative;
        }

        .bar:hover {
            filter: brightness(1.2);
        }

        .bar-label {
            font-size: 10px;
            color: #A78BFA;
            font-family: 'Syne', sans-serif;
            font-weight: 700;
        }

        .chart-y-axis {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding-bottom: 20px;
        }

        .chart-y-label {
            font-size: 10px;
            color: #6b5f8a;
        }

        /* ── Sidebar nav item ── */
        .nav-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
            position: relative;
            overflow: hidden;
            background: none;
            text-align: left;
            width: 100%;
            color: rgba(196, 181, 253, 0.5);
            font-size: 13px;
            font-weight: 500;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.05);
            color: #d8b4fe;
        }

        .nav-btn.active {
            background: linear-gradient(to right, rgba(139, 92, 246, 0.2), rgba(139, 92, 246, 0.05));
            color: #A78BFA;
            border-color: rgba(139, 92, 246, 0.3);
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.25);
        }

        .nav-btn.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 25%;
            bottom: 25%;
            width: 2px;
            background: #8B5CF6;
            border-radius: 0 2px 2px 0;
        }

        .nav-btn.logout-btn {
            color: rgba(248, 113, 113, 0.7);
        }

        .nav-btn.logout-btn:hover {
            background: rgba(239, 68, 68, 0.1);
            color: #f87171;
            border-color: rgba(239, 68, 68, 0.2);
        }

        /* ── Cal day ── */
        .cal-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s;
            position: relative;
            color: rgba(196, 181, 253, 0.6);
            border: 1px solid transparent;
        }

        .cal-day:hover {
            background: rgba(139, 92, 246, 0.1);
            color: #d8b4fe;
        }

        .cal-day.today {
            background: linear-gradient(135deg, #7c3aed, #EC4899);
            color: #fff;
            font-weight: 700;
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.25);
        }

        .cal-day.selected:not(.today) {
            background: rgba(139, 92, 246, 0.15);
            border-color: rgba(139, 92, 246, 0.4);
            color: #A78BFA;
        }

        .cal-day.has-dl::after {
            content: '';
            position: absolute;
            bottom: 3px;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: #EC4899;
        }

        .cal-day.today.has-dl::after {
            background: rgba(255, 255, 255, 0.8);
        }

        /* ── Form inputs ── */
        .form-input {
            width: 100%;
            background: #181828;
            border: 1px solid rgba(139, 92, 246, 0.15);
            border-radius: 10px;
            padding: 9px 13px;
            font-size: 13px;
            color: #f0eaff;
            outline: none;
            font-family: 'DM Sans', sans-serif;
            transition: border-color 0.2s;
        }

        .form-input:focus {
            border-color: rgba(139, 92, 246, 0.4);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.06);
        }

        .form-input::placeholder {
            color: rgba(139, 92, 246, 0.3);
        }

        select.form-input option {
            background: #181828;
        }

        /* ── Collapsed sidebar ── */
        #sidebar.collapsed {
            width: 64px;
        }

        #sidebar.collapsed .nav-label,
        #sidebar.collapsed .nav-text,
        #sidebar.collapsed .logo-text {
            display: none;
        }

        #sidebar.collapsed .nav-btn {
            justify-content: center;
            padding: 10px;
        }

        #sidebar.collapsed .logo-area {
            justify-content: center;
        }

        #sidebar.collapsed #toggleIcon {
            transform: rotate(180deg);
        }

        /* ── Section fade-in ── */
        .section-view {
            animation: fadeInUp 0.3s ease both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="bg-bg overflow-hidden h-screen">
    <div class="flex h-screen w-screen overflow-hidden">

        <!-- ══════════ SIDEBAR ══════════ -->
        <aside id="sidebar"
            class="sidebar-glow flex flex-col h-screen bg-sidebar transition-all duration-300 ease-in-out flex-shrink-0 relative z-20"
            style="width:240px">

            <!-- Top accent line -->
            <div
                class="absolute top-0 left-0 right-0 h-0.5 bg-gradient-to-r from-transparent via-accent to-transparent opacity-60">
            </div>

            <!-- Logo -->
            <div class="logo-area flex items-center gap-3 px-4 py-6 border-b border-white/5">
                <div class="flex items-center gap-3">
                    <div
                        class="w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-lg shadow-indigo-500/20">
                        <span class="font-syne font-black text-white text-lg">S</span>
                    </div>
                    <div>
                        <h1 class="font-display font-bold text-white text-sm leading-tight">StudySync</h1>
                        <p class="text-[9px] text-accent3 font-bold uppercase tracking-widest">Faculty Hub</p>
                    </div>
                </div>
            </div>

            <!-- Toggle button -->
            <button onclick="toggleSidebar()"
                class="absolute -right-3 top-20 w-6 h-6 rounded-full bg-sidebar border border-accent/30 flex items-center justify-center text-accent hover:bg-accent hover:text-white transition-all duration-200 z-30">
                <svg id="toggleIcon" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M15 18l-6-6 6-6" />
                </svg>
            </button>

            <!-- Nav -->
            <nav class="flex-1 py-4 px-2 flex flex-col gap-1 overflow-y-auto">
                <div
                    class="nav-label text-[9px] font-bold text-purple-500/50 uppercase tracking-[0.15em] px-3 pt-2 pb-1 mb-1">
                    Navigation</div>
                <button class="nav-btn active" data-section="overview" onclick="navTo('overview',this)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z M9 22V12h6v10" />
                    </svg>
                    <span class="nav-text">Dashboard</span>
                </button>
                <button class="nav-btn" data-section="courses" onclick="navTo('courses',this)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                    </svg>
                    <span class="nav-text">My Courses</span>
                </button>
                <button class="nav-btn" data-section="faculty-timetable" onclick="navTo('faculty-timetable',this)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M8 2v4M16 2v4M3 10h18M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2z" />
                    </svg>
                    <span class="nav-text">Faculty Timetable</span>
                </button>
                <button class="nav-btn" data-section="student-timetable" onclick="navTo('student-timetable',this)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2M9 11a4 4 0 100-8 4 4 0 000 8zM23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75" />
                    </svg>
                    <span class="nav-text">Student Timetable</span>
                </button>
                <button class="nav-btn" data-section="strength" onclick="navTo('strength',this)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 20V10M12 20V4M6 20v-6" />
                    </svg>
                    <span class="nav-text">Course Strength</span>
                </button>
                <button class="nav-btn" data-section="notifications" onclick="navTo('notifications',this)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0" />
                    </svg>
                    <span class="nav-text">Dept Circulars</span>
                </button>
                <button class="nav-btn" data-section="upload-files" onclick="navTo('upload-files',this)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12" />
                    </svg>
                    <span class="nav-text">Upload Files</span>
                </button>
                <button class="nav-btn" data-section="calendar" onclick="navTo('calendar',this)">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M8 2v4M16 2v4M3 10h18M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2z" />
                    </svg>
                    <span class="nav-text">Calendar</span>
                </button>
            </nav>

            <!-- Logout moved to profile dropdown -->
            <div class="p-2 border-t border-white/5">
                <div class="px-3 py-2 text-[10px] text-purple-500/40 uppercase tracking-widest">Use profile menu to
                    logout</div>
            </div>
        </aside>

        <!-- ══════════ MAIN ══════════ -->
        <div class="flex-1 flex flex-col overflow-hidden min-w-0">

            <!-- NAVBAR -->
            <header
                class="h-16 bg-card border-b border-white/5 flex items-center justify-between px-6 flex-shrink-0 z-10">
                <div class="font-display font-semibold text-white text-[15px] tracking-wide" id="navTitle">Dashboard
                    Overview</div>
                <div class="flex items-center gap-3">
                    <!-- Notification Bell -->
                    <div class="relative" id="notif-bell-wrap">
                        <button id="notif-bell-btn" onclick="toggleNotifDropdown()"
                            class="relative w-9 h-9 rounded-lg bg-card2 border border-white/10 flex items-center justify-center text-purple-300 hover:text-accent transition-colors">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0" />
                            </svg>
                            <span id="notif-badge"
                                class="absolute top-1 right-1 w-2 h-2 rounded-full bg-pink border-2 border-card hidden"></span>
                        </button>
                        <!-- Notif Dropdown -->
                        <div id="notif-dropdown"
                            class="hidden absolute right-0 top-12 w-80 bg-card2 border border-white/10 rounded-2xl shadow-2xl z-50 overflow-hidden">
                            <div class="flex items-center justify-between px-4 py-3 border-b border-white/5"
                                style="background:rgba(139,92,246,0.05)">
                                <span class="text-xs font-display font-bold text-white">Recent Notifications</span>
                                <span class="text-[9px] text-purple-400/60 font-bold uppercase tracking-widest">Last
                                    3</span>
                            </div>
                            <div id="notif-dropdown-list" class="divide-y divide-white/5 max-h-72 overflow-y-auto">
                                <p class="text-xs text-white/20 italic p-4">No notifications.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Profile Dropdown -->
                    <div class="relative" id="profile-wrap">
                        <button id="profile-btn" onclick="toggleProfileDropdown()"
                            class="flex items-center gap-2.5 pl-2 pr-3 py-1.5 bg-card2 border border-white/10 rounded-full hover:border-accent/30 transition-all cursor-pointer">
                            <div
                                class="faculty-initials w-8 h-8 rounded-full bg-gradient-to-br from-accent2 to-pink flex items-center justify-center font-display font-bold text-white text-xs flex-shrink-0">
                                …</div>
                            <div class="hidden sm:block text-left">
                                <div class="faculty-name text-[12px] font-medium text-white leading-tight">Loading…
                                </div>
                                <div class="text-[10px] text-purple-400/60 uppercase tracking-wider">Faculty</div>
                            </div>
                            <svg class="w-3 h-3 text-white/30 ml-1" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <path d="M6 9l6 6 6-6" />
                            </svg>
                        </button>

                        <!-- Profile Dropdown Panel -->
                        <div id="profile-dropdown"
                            class="hidden absolute right-0 top-12 w-72 bg-card2 border border-white/10 rounded-2xl shadow-2xl z-50 overflow-hidden">
                            <div class="p-5 border-b border-white/5"
                                style="background:linear-gradient(135deg,rgba(139,92,246,0.1),rgba(236,72,153,0.05))">
                                <div class="flex items-center gap-3 mb-4">
                                    <div
                                        class="faculty-initials w-12 h-12 rounded-full bg-gradient-to-br from-accent2 to-pink flex items-center justify-center font-display font-bold text-white text-lg border-2 border-accent/30">
                                        …</div>
                                    <div>
                                        <p class="text-sm font-bold text-white faculty-name">Faculty</p>
                                        <p class="text-[10px] text-purple-400 uppercase tracking-wider"
                                            id="prof-emp-id">--</p>
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-2">
                                    <div class="p-2 rounded-xl" style="background:rgba(255,255,255,0.05)">
                                        <p class="text-[8px] text-white/30 uppercase tracking-wider">Department</p>
                                        <p class="text-xs font-bold text-white" id="prof-dept">--</p>
                                    </div>
                                    <div class="p-2 rounded-xl" style="background:rgba(255,255,255,0.05)">
                                        <p class="text-[8px] text-white/30 uppercase tracking-wider">Courses</p>
                                        <p class="text-xs font-bold text-white" id="prof-courses">--</p>
                                    </div>
                                    <div class="col-span-2 p-2 rounded-xl" style="background:rgba(255,255,255,0.05)">
                                        <p class="text-[8px] text-white/30 uppercase tracking-wider">Email</p>
                                        <p class="text-xs font-bold text-purple-300 truncate" id="prof-email">--</p>
                                    </div>
                                </div>
                            </div>
                            <div class="p-2">
                                <button onclick="closeAllDropdowns()"
                                    class="w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-sm text-white/70 hover:bg-white/5 hover:text-white transition-all">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#A78BFA"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path
                                            d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2M12 11a4 4 0 100-8 4 4 0 000 8z" />
                                    </svg>
                                    My Profile
                                </button>
                                <button onclick="handleLogout()"
                                    class="w-full flex items-center gap-3 px-4 py-2.5 rounded-xl text-sm text-red-400 hover:bg-red-500/10 transition-all">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9" />
                                    </svg>
                                    Sign Out
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- CONTENT AREA -->
            <div class="flex-1 overflow-y-auto p-7" id="contentArea">

                <!-- ════ OVERVIEW ════ -->
                <div id="view-overview" class="section-view flex flex-col gap-6">
                    <!-- Alert -->
                    <div class="flex items-center gap-3 px-4 py-3 rounded-xl text-emerald-300 text-sm"
                        style="background:rgba(16,185,129,0.08);border:1px solid rgba(16,185,129,0.25)">
                        <div class="w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0"
                            style="background:rgba(16,185,129,0.2)">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#6ee7b7"
                                stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20 6L9 17l-5-5" />
                            </svg>
                        </div>
                        Login successful. Welcome back to your faculty portal.
                    </div>

                    <!-- Greeting card -->
                    <div class="relative bg-card border border-white/5 rounded-2xl p-7 overflow-hidden">
                        <div class="absolute right-0 top-0 w-64 h-64 rounded-full pointer-events-none"
                            style="background:radial-gradient(circle,rgba(139,92,246,0.06),transparent);filter:blur(40px)">
                        </div>
                        <div class="relative">
                            <span
                                class="inline-block text-[11px] font-semibold text-accent3 bg-accent/10 border border-accent/20 px-3 py-1 rounded-full uppercase tracking-wider mb-3"
                                id="greetBadge">Good Morning</span>
                            <h1 class="font-display text-3xl font-bold text-white leading-tight">
                                Welcome back, <span class="text-gradient">Professor</span>
                            </h1>
                            <p class="text-purple-300/60 text-sm mb-5" id="dateStr"></p>
                            <div class="flex items-center gap-2 text-xs text-purple-400/50">
                                <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path
                                        d="M8 2v4M16 2v4M3 10h18M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2z" />
                                </svg>
                                <span id="todayClasses">You have 2 classes today</span>
                            </div>
                        </div>
                    </div>

                    <!-- Stat Cards -->
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-4" id="statCards">
                        <div class="h-28 rounded-2xl shimmer"></div>
                        <div class="h-28 rounded-2xl shimmer"></div>
                        <div class="h-28 rounded-2xl shimmer"></div>
                        <div class="h-28 rounded-2xl shimmer"></div>
                    </div>
                </div>

                <!-- ════ COURSES ════ -->
                <div id="view-courses" class="section-view flex-col gap-5 hidden">
                    <div class="flex items-center gap-2">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#A78BFA" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path
                                d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                        </svg>
                        <h2 id="view-title" class="font-display font-bold text-white text-sm">Dashboard Overview</h2>
                        <div class="h-0.5 flex-1 rounded-full ml-1"
                            style="background:linear-gradient(to right,rgba(139,92,246,0.3),transparent)"></div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4" id="coursesGrid">
                        <div class="h-44 rounded-2xl shimmer"></div>
                        <div class="h-44 rounded-2xl shimmer"></div>
                        <div class="h-44 rounded-2xl shimmer"></div>
                        <div class="h-44 rounded-2xl shimmer"></div>
                        <div class="h-44 rounded-2xl shimmer"></div>
                    </div>
                </div>

                <!-- ════ FACULTY TIMETABLE ════ -->
                <div id="view-faculty-timetable" class="section-view flex-col gap-5 hidden">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#A78BFA"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path
                                    d="M8 2v4M16 2v4M3 10h18M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2z" />
                            </svg>
                            <h2 class="font-display font-bold text-white text-base">Faculty Timetable</h2>
                            <div class="h-0.5 w-16 rounded-full ml-1"
                                style="background:linear-gradient(to right,rgba(139,92,246,0.3),transparent)"></div>
                        </div>
                        <div class="flex items-center gap-1.5 text-[11px]">
                            <span class="w-2.5 h-2.5 rounded-full bg-accent inline-block"></span>
                            <span class="text-purple-300/50" id="ftTodayLabel">Today: —</span>
                        </div>
                    </div>
                    <!-- Day filter -->
                    <div class="flex gap-2 flex-wrap" id="ftDayFilter"></div>
                    <!-- Table -->
                    <div class="bg-card border border-white/5 rounded-2xl overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full timetable">
                                <thead>
                                    <tr>
                                        <th>Day</th>
                                        <th>Time</th>
                                        <th>Course</th>
                                        <th>Classroom</th>
                                        <th>Semester</th>
                                    </tr>
                                </thead>
                                <tbody id="ftTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ════ STUDENT TIMETABLE ════ -->
                <div id="view-student-timetable" class="section-view flex-col gap-5 hidden">
                    <div class="flex items-center gap-2">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#A78BFA" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path
                                d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2M9 11a4 4 0 100-8 4 4 0 000 8zM23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75" />
                        </svg>
                        <h2 class="font-display font-bold text-white text-base">Student Timetable View</h2>
                        <div class="h-0.5 w-12 rounded-full ml-1"
                            style="background:linear-gradient(to right,rgba(139,92,246,0.3),transparent)"></div>
                        <span class="text-[10px] text-purple-400/40 ml-1 italic">Read-only</span>
                    </div>
                    <div class="flex flex-wrap gap-4">
                        <div class="flex flex-col gap-1.5">
                            <label class="text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider">Select
                                Semester</label>
                            <div class="flex gap-2" id="stSemBtns"></div>
                        </div>
                        <div class="flex flex-col gap-1.5">
                            <label class="text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider">Select
                                Section</label>
                            <div class="flex gap-2" id="stSecBtns"></div>
                        </div>
                    </div>
                    <div class="bg-card border border-white/5 rounded-2xl overflow-hidden">
                        <div class="px-5 py-3 border-b border-white/5 flex items-center justify-between"
                            style="background:rgba(139,92,246,0.05)">
                            <span class="font-display text-[12px] font-semibold text-accent3" id="stTableTitle">—</span>
                            <span class="text-[11px] text-purple-300/40" id="stTableCount">0 classes/week</span>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full timetable">
                                <thead>
                                    <tr>
                                        <th>Day</th>
                                        <th>Time</th>
                                        <th>Subject</th>
                                        <th>Faculty</th>
                                        <th>Room</th>
                                    </tr>
                                </thead>
                                <tbody id="stTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ════ COURSE STRENGTH ════ -->
                <div id="view-strength" class="section-view flex-col gap-5 hidden">
                    <div class="flex items-center gap-2">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#A78BFA" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 20V10M12 20V4M6 20v-6" />
                        </svg>
                        <h2 class="font-display font-bold text-white text-base">Course Strength</h2>
                        <div class="h-0.5 flex-1 rounded-full ml-1"
                            style="background:linear-gradient(to right,rgba(139,92,246,0.3),transparent)"></div>
                    </div>
                    <!-- Bar chart -->
                    <div class="bg-card border border-white/5 rounded-2xl p-5">
                        <p class="text-[11px] text-purple-300/40 mb-5 font-medium uppercase tracking-wider">Student
                            Distribution by Course</p>
                        <div class="flex gap-2 items-end" style="height:220px" id="barChart"></div>
                        <div class="flex items-center justify-center gap-6 mt-4">
                            <div class="flex items-center gap-2"><span
                                    class="w-3 h-3 rounded-sm bg-accent inline-block"></span><span
                                    class="text-xs text-purple-300/60">Male</span></div>
                            <div class="flex items-center gap-2"><span
                                    class="w-3 h-3 rounded-sm bg-pink inline-block"></span><span
                                    class="text-xs text-purple-300/60">Female</span></div>
                        </div>
                    </div>
                    <!-- Cards -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="strengthCards">
                        <div class="h-32 rounded-2xl shimmer"></div>
                        <div class="h-32 rounded-2xl shimmer"></div>
                        <div class="h-32 rounded-2xl shimmer"></div>
                        <div class="h-32 rounded-2xl shimmer"></div>
                        <div class="h-32 rounded-2xl shimmer"></div>
                    </div>
                </div>

                <!-- ════ DEPT CIRCULARS ════ -->
                <div id="view-notifications" class="section-view flex-col gap-5 hidden">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#A78BFA"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0" />
                            </svg>
                            <h2 class="font-display font-bold text-white text-base">Department Circulars</h2>
                            <div class="h-0.5 w-12 rounded-full ml-1"
                                style="background:linear-gradient(to right,rgba(139,92,246,0.3),transparent)"></div>
                        </div>
                        <button onclick="openNotifModal()"
                            class="flex items-center gap-2 px-4 py-2 rounded-xl text-white text-[13px] font-display font-semibold hover:-translate-y-0.5 transition-all duration-200"
                            style="background:linear-gradient(to right,#7c3aed,#EC4899)">
                            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" />
                            </svg>
                            Send Circular
                        </button>
                    </div>
                    <!-- Tabs -->
                    <div class="flex gap-2">
                        <button
                            class="notif-tab flex items-center gap-2 px-4 py-2.5 rounded-xl border text-[13px] font-medium transition-all duration-200 bg-accent/15 border-accent/40 text-accent3 shadow-glow"
                            data-tab="hod" onclick="switchNotifTab('hod',this)">
                            HOD Notices <span
                                class="text-[11px] font-bold px-1.5 py-0.5 rounded-md bg-white/5 text-amber-400"
                                id="hodCount">3</span>
                        </button>
                        <button
                            class="notif-tab flex items-center gap-2 px-4 py-2.5 rounded-xl border text-[13px] font-medium transition-all duration-200 bg-card2 border-white/5 text-purple-300/50 hover:border-accent/20"
                            data-tab="sent" onclick="switchNotifTab('sent',this)">
                            Sent to Students <span
                                class="text-[11px] font-bold px-1.5 py-0.5 rounded-md bg-white/5 text-cyan"
                                id="sentCount">3</span>
                        </button>
                    </div>
                    <div class="flex flex-col gap-3" id="notifList"></div>
                </div>

                <!-- ════ UPLOAD FILES ════ -->
                <div id="view-upload-files" class="section-view flex-col gap-5 hidden">
                    <div class="flex items-center gap-2">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#A78BFA" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12" />
                        </svg>
                        <h2 class="font-display font-bold text-white text-base">Upload Study Material</h2>
                    </div>
                    <div class="bg-card border border-white/5 rounded-2xl p-7 max-w-2xl">
                        <div class="flex flex-col gap-5">
                            <div>
                                <label
                                    class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Target
                                    Subject</label>
                                <select id="uSubject" class="form-input"></select>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label
                                        class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Semester</label>
                                    <select id="uSemester" class="form-input">
                                        <option value="1">Semester 1</option>
                                        <option value="2">Semester 2</option>
                                        <option value="3">Semester 3</option>
                                        <option value="4">Semester 4</option>
                                        <option value="5">Semester 5</option>
                                        <option value="6" selected>Semester 6</option>
                                        <option value="7">Semester 7</option>
                                        <option value="8">Semester 8</option>
                                    </select>
                                </div>
                                <div>
                                    <label
                                        class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Unit/Module</label>
                                    <select id="uUnit" class="form-input">
                                        <option value="1">Unit 1</option>
                                        <option value="2">Unit 2</option>
                                        <option value="3">Unit 3</option>
                                    </select>
                                </div>
                            </div>
                            <div class="border-2 border-dashed border-white/10 rounded-2xl p-10 text-center hover:border-accent/30 transition-all cursor-pointer group"
                                onclick="document.getElementById('fUpload').click()">
                                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                    class="mx-auto mb-3 text-purple-300/30 group-hover:text-accent transition-colors">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12" />
                                </svg>
                                <p class="text-sm text-purple-300/50 group-hover:text-purple-300 transition-colors"
                                    id="fNameText">Click to select file or drag and drop</p>
                                <input type="file" id="fUpload" class="hidden" onchange="handleFileChange(this)">
                            </div>
                            <button onclick="performFileUpload()" id="uBtn"
                                class="w-full py-3 rounded-xl text-white font-display font-bold text-sm bg-gradient-to-r from-accent2 to-pink shadow-glow hover:-translate-y-0.5 transition-all">Upload
                                and Notify Students</button>
                        </div>
                    </div>
                </div>

                <!-- ════ CALENDAR ════ -->
                <div id="view-calendar" class="section-view flex-col gap-5 hidden">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#A78BFA"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path
                                    d="M8 2v4M16 2v4M3 10h18M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2z" />
                            </svg>
                            <h2 class="font-display font-bold text-white text-base">Calendar Management</h2>
                            <div class="h-0.5 w-10 rounded-full ml-1"
                                style="background:linear-gradient(to right,rgba(139,92,246,0.3),transparent)"></div>
                        </div>
                        <button onclick="openAddModal()"
                            class="flex items-center gap-2 px-4 py-2 rounded-xl text-white text-[13px] font-display font-semibold hover:-translate-y-0.5 transition-all"
                            style="background:linear-gradient(to right,#7c3aed,#EC4899)">
                            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 5v14M5 12h14" />
                            </svg>
                            Add Deadline
                        </button>
                    </div>
                    <div class="grid grid-cols-1 lg:grid-cols-[340px_1fr] gap-4 items-start">
                        <!-- Calendar widget -->
                        <div class="bg-card border border-white/5 rounded-2xl p-5">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="font-display font-bold text-white text-[15px]" id="calMonthLabel"></h3>
                                <div class="flex gap-1.5">
                                    <button onclick="changeMonth(-1)"
                                        class="w-7 h-7 rounded-lg bg-card2 border border-white/10 flex items-center justify-center text-purple-300 hover:text-accent hover:border-accent/30 transition-all">‹</button>
                                    <button onclick="changeMonth(1)"
                                        class="w-7 h-7 rounded-lg bg-card2 border border-white/10 flex items-center justify-center text-purple-300 hover:text-accent hover:border-accent/30 transition-all">›</button>
                                </div>
                            </div>
                            <div class="grid grid-cols-7 mb-1">
                                <div
                                    class="text-[10px] font-bold text-purple-400/40 uppercase tracking-wider text-center py-1">
                                    Su</div>
                                <div
                                    class="text-[10px] font-bold text-purple-400/40 uppercase tracking-wider text-center py-1">
                                    Mo</div>
                                <div
                                    class="text-[10px] font-bold text-purple-400/40 uppercase tracking-wider text-center py-1">
                                    Tu</div>
                                <div
                                    class="text-[10px] font-bold text-purple-400/40 uppercase tracking-wider text-center py-1">
                                    We</div>
                                <div
                                    class="text-[10px] font-bold text-purple-400/40 uppercase tracking-wider text-center py-1">
                                    Th</div>
                                <div
                                    class="text-[10px] font-bold text-purple-400/40 uppercase tracking-wider text-center py-1">
                                    Fr</div>
                                <div
                                    class="text-[10px] font-bold text-purple-400/40 uppercase tracking-wider text-center py-1">
                                    Sa</div>
                            </div>
                            <div class="grid grid-cols-7 gap-0.5" id="calGrid"></div>
                            <div
                                class="mt-4 pt-4 border-t border-white/5 flex items-center gap-4 text-[11px] text-purple-300/40">
                                <div class="flex items-center gap-1.5"><span
                                        class="w-2 h-2 rounded-full bg-pink inline-block"></span> Deadline</div>
                                <div class="flex items-center gap-1.5"><span
                                        class="w-2 h-2 rounded-full bg-accent inline-block"></span> Today</div>
                            </div>
                        </div>
                        <!-- Deadline panel -->
                        <div class="bg-card border border-white/5 rounded-2xl p-5 min-h-[320px]">
                            <h3 class="font-display font-semibold text-[13px] text-accent3 mb-4" id="dlPanelTitle">
                                Select a date to view deadlines</h3>
                            <div id="dlPanel">
                                <div class="flex flex-col items-center justify-center h-52 text-purple-300/25 gap-3">
                                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path
                                            d="M8 2v4M16 2v4M3 10h18M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2z" />
                                    </svg>
                                    <span class="text-sm">Click a date with a pink dot</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div><!-- /contentArea -->
        </div><!-- /main -->
    </div><!-- /app -->

    <!-- ══════════ MODALS ══════════ -->

    <!-- Send Notification Modal -->
    <div id="notifModal" class="modal-backdrop fixed inset-0 z-50 flex items-center justify-center hidden"
        style="background:rgba(0,0,0,0.7);backdrop-filter:blur(8px)">
        <div class="modal-box bg-card border border-accent/30 rounded-2xl p-7 w-full max-w-md shadow-glow2"
            style="box-shadow:0 24px 80px rgba(0,0,0,0.6)">
            <div class="flex items-center justify-between mb-5">
                <h3 class="font-display font-bold text-white text-lg">Send Department Circular</h3>
                <button onclick="closeNotifModal()"
                    class="w-7 h-7 bg-card2 border border-white/10 rounded-lg flex items-center justify-center text-purple-300 hover:text-red-400 transition-colors">
                    <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="flex flex-col gap-4">
                <div><label
                        class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Select
                        Course</label>
                    <select id="nCourse" class="form-input">
                        <option value="CS301">CS301 — Data Structures & Algorithms</option>
                        <option value="CS302">CS302 — Operating Systems</option>
                        <option value="CS401">CS401 — Machine Learning</option>
                        <option value="CS402">CS402 — Software Engineering</option>
                        <option value="CS403">CS403 — Computer Networks</option>
                    </select>
                </div>
                <div><label
                        class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Title</label>
                    <input id="nTitle" class="form-input" placeholder="Notification title..." />
                </div>
                <div><label
                        class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Message</label>
                    <textarea id="nMessage" class="form-input" style="resize:none;min-height:90px"
                        placeholder="Write your message..."></textarea>
                </div>
                <div><label
                        class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Priority</label>
                    <select id="nPriority" class="form-input">
                        <option value="High">High</option>
                        <option value="Medium" selected>Medium</option>
                        <option value="Low">Low</option>
                    </select>
                </div>
                <button onclick="sendNotification()"
                    class="w-full py-3 rounded-xl text-white font-display font-bold text-sm mt-1 hover:-translate-y-0.5 transition-all"
                    style="background:linear-gradient(135deg,#7c3aed,#EC4899);box-shadow:0 4px 18px rgba(124,58,237,0.4)">Send
                    Circular</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit Deadline Modal -->
    <div id="dlModal" class="modal-backdrop fixed inset-0 z-50 flex items-center justify-center hidden"
        style="background:rgba(0,0,0,0.7);backdrop-filter:blur(8px)">
        <div class="modal-box bg-card border border-accent/30 rounded-2xl p-7 w-full max-w-md shadow-glow2">
            <div class="flex items-center justify-between mb-5">
                <h3 class="font-display font-bold text-white text-lg" id="dlModalTitle">Add Deadline</h3>
                <button onclick="closeDlModal()"
                    class="w-7 h-7 bg-card2 border border-white/10 rounded-lg flex items-center justify-center text-purple-300 hover:text-red-400 transition-colors">
                    <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="flex flex-col gap-4">
                <div><label
                        class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Course</label>
                    <select id="dlCourse" class="form-input">
                        <option value="CS301">CS301 — Data Structures & Algorithms</option>
                        <option value="CS302">CS302 — Operating Systems</option>
                        <option value="CS401">CS401 — Machine Learning</option>
                        <option value="CS402">CS402 — Software Engineering</option>
                        <option value="CS403">CS403 — Computer Networks</option>
                    </select>
                </div>
                <div><label
                        class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Title</label>
                    <input id="dlTitle" class="form-input" placeholder="Assignment / Exam title..." />
                </div>
                <div><label
                        class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Description</label>
                    <textarea id="dlDesc" class="form-input" style="resize:none;min-height:70px"
                        placeholder="Details..."></textarea>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div><label
                            class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Due
                            Date</label>
                        <input type="date" id="dlDate" class="form-input" />
                    </div>
                    <div><label
                            class="block text-[11px] font-semibold text-purple-300/50 uppercase tracking-wider mb-2">Time</label>
                        <input type="time" id="dlTime" class="form-input" />
                    </div>
                </div>
                <button onclick="saveDl()" id="dlSaveBtn"
                    class="w-full py-3 rounded-xl text-white font-display font-bold text-sm mt-1 hover:-translate-y-0.5 transition-all"
                    style="background:linear-gradient(135deg,#7c3aed,#EC4899);box-shadow:0 4px 18px rgba(124,58,237,0.4)">Add
                    Deadline</button>
            </div>
        </div>
    </div>

    <!-- View Students Modal -->
    <div id="studentsModal" class="modal-backdrop fixed inset-0 z-50 flex items-center justify-center hidden"
        style="background:rgba(0,0,0,0.7);backdrop-filter:blur(8px)">
        <div
            class="modal-box bg-card border border-accent/30 rounded-2xl p-7 w-full max-w-4xl max-h-[80vh] flex flex-col shadow-glow2">
            <div class="flex items-center justify-between mb-5">
                <div>
                    <h3 class="font-display font-bold text-white text-lg" id="sModalTitle">Enrolled Students</h3>
                    <p class="text-xs text-purple-300/40" id="sModalSub">Course Details</p>
                </div>
                <button onclick="closeStudentsModal()"
                    class="w-7 h-7 bg-card2 border border-white/10 rounded-lg flex items-center justify-center text-purple-300 hover:text-red-400 transition-colors">
                    <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 6L6 18M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="overflow-y-auto flex-1">
                <table class="w-full timetable">
                    <thead>
                        <tr>
                            <th>USN</th>
                            <th>Name</th>
                            <th>Semester</th>
                            <th>MSE 1</th>
                            <th>MSE 2</th>
                            <th>Assig. 1</th>
                            <th>Assig. 2</th>
                        </tr>
                    </thead>
                    <tbody id="sTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ══════════ SCRIPT ══════════ -->
    <script>
        // ── Data (populated via API on load) ─────────────────────────────────────────
        let COURSES = [];
        let FACULTY_TT = [];
        let STUDENT_TT = {};
        let STRENGTH = [];
        let NOTIFS = { hod: [], sent: [] };
        let DEADLINES = [];

        // ── Live fetch from /api/faculty/dashboard ────────────────────────────────────
        async function loadDashboardData() {
            try {
                const res = await fetch('/api/faculty/dashboard', { credentials: 'include' });
                if (!res.ok) { window.location.href = '/'; return; }
                const json = await res.json();
                if (!json.success) { window.location.href = '/'; return; }

                const d = json.data;
                const p = d.profile;

                // ── Profile UI ────────────────────────────────────────────────────────
                const initials = p.name.split(' ').map(w => w[0]).join('').slice(0, 2).toUpperCase();
                document.querySelectorAll('.faculty-initials').forEach(el => el.textContent = initials);
                document.querySelectorAll('.faculty-name').forEach(el => el.textContent = p.name);
                document.querySelectorAll('.faculty-dept').forEach(el => el.textContent = p.department);
                document.querySelectorAll('.faculty-id').forEach(el => el.textContent = p.id);
                document.querySelectorAll('.faculty-email').forEach(el => el.textContent = p.email);

                // Populate profile dropdown extra fields
                document.getElementById('prof-emp-id').textContent = p.id || '--';
                document.getElementById('prof-dept').textContent = p.department || '--';
                document.getElementById('prof-courses').textContent = p.total_courses || '0';
                document.getElementById('prof-email').textContent = p.email || '--';

                // ── Notification Dropdown (last 3) ──────────────────────────────────
                const allNotifs = [...(d.notifications.hod || []), ...(d.notifications.sent || [])]
                    .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                const recent3 = allNotifs.slice(0, 3);
                const badge = document.getElementById('notif-badge');
                if (recent3.length > 0) badge.classList.remove('hidden');

                const dropList = document.getElementById('notif-dropdown-list');
                if (recent3.length) {
                    dropList.innerHTML = recent3.map(n => `
                        <div class="px-4 py-3 hover:bg-white/3 transition-all">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-[9px] font-bold px-1.5 py-0.5 rounded uppercase tracking-wider ${priorityStyle[n.priority] || ''}">${n.priority}</span>
                                <span class="text-[9px] text-purple-400/40">${n.timestamp}</span>
                            </div>
                            <p class="text-[12px] font-bold text-white leading-tight mb-0.5 truncate">${n.title}</p>
                            <p class="text-[11px] text-purple-300/50 leading-relaxed line-clamp-2">${n.message}</p>
                        </div>
                    `).join('');
                } else {
                    dropList.innerHTML = `<p class="text-xs text-white/20 italic p-4">No notifications yet.</p>`;
                }

                // ── Populate data arrays ───────────────────────────────────────────────
                COURSES = d.courses.map(c => ({
                    id: c.id,
                    code: c.code,
                    name: c.name,
                    students: c.students_count,
                    semester: 'Sem',      // DB has no semester field on Course yet
                    section: '—',
                }));

                STRENGTH = d.strength;
                DEADLINES = d.deadlines;
                FACULTY_TT = d.faculty_tt;
                STUDENT_TT = d.student_tt;
                NOTIFS = d.notifications;

                // ── Boot UI ───────────────────────────────────────────────────────────
                initGreeting(p.name);
                syncCourseSelects();
                document.getElementById('view-overview').classList.add('flex');
                setTimeout(renderOverview, 200);

            } catch (err) {
                console.error('Dashboard load failed:', err);
                window.location.href = '/';
            }
        }

        // ── State ─────────────────────────────────────────────────────────────────────
        const DAYS_MAP = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const MONTHS = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
        const today = new Date();
        const todayName = DAYS_MAP[today.getDay()];

        let calViewDate = new Date(2026, 1, 1);
        let calSelected = null;
        let dlEditId = null;
        let ftFilter = 'All';
        let stSem = 'Sem 3';
        let stSec = 'A';
        let activeNotifTab = 'hod';

        const sectionTitles = {
            'overview': 'Dashboard Overview',
            'courses': 'My Courses',
            'faculty-timetable': 'Faculty Timetable',
            'student-timetable': 'Student Timetable',
            'strength': 'Course Strength',
            'notifications': 'Department Circulars',
            'upload-files': 'Upload Study Material',
            'calendar': 'Calendar Management',
        };

        function syncCourseSelects() {
            const courseHTML = COURSES.map(c => `<option value="${c.id}" data-code="${c.code}">${c.code} — ${c.name}</option>`).join('');
            const nCourse = document.getElementById('nCourse');
            const dlCourse = document.getElementById('dlCourse');
            const uSubject = document.getElementById('uSubject');
            if (nCourse) nCourse.innerHTML = courseHTML;
            if (dlCourse) dlCourse.innerHTML = courseHTML;
            if (uSubject) uSubject.innerHTML = courseHTML;
        }

        // ── Nav ───────────────────────────────────────────────────────────────────────
        function navTo(section, el) {
            document.querySelectorAll('.nav-btn:not(.logout-btn)').forEach(b => b.classList.remove('active'));
            el.classList.add('active');
            document.querySelectorAll('.section-view').forEach(v => {
                v.classList.add('hidden');
                v.classList.remove('flex');
            });
            const view = document.getElementById('view-' + section);
            if (view) { view.classList.remove('hidden'); view.classList.add('flex'); }
            document.getElementById('navTitle').textContent = sectionTitles[section] || 'Dashboard';
            // lazy-render
            if (section === 'overview') renderOverview();
            if (section === 'courses') renderCourses();
            if (section === 'faculty-timetable') renderFacultyTT();
            if (section === 'student-timetable') renderStudentTT();
            if (section === 'strength') renderStrength();
            if (section === 'notifications') renderNotifs();
            if (section === 'calendar') { renderCalendar(); renderDlPanel(); }
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
        }

        async function handleLogout() {
            if (confirm("Log out of FacultySync?")) {
                try {
                    await fetch('/api/auth/logout', { method: 'POST', credentials: 'include' });
                } catch (e) { }
                window.location.href = '/';
            }
        }

        // ── Dropdown Logic ─────────────────────────────────────────
        function toggleNotifDropdown() {
            const dd = document.getElementById('notif-dropdown');
            const profileDd = document.getElementById('profile-dropdown');
            profileDd.classList.add('hidden');
            dd.classList.toggle('hidden');
        }

        function toggleProfileDropdown() {
            const dd = document.getElementById('profile-dropdown');
            const notifDd = document.getElementById('notif-dropdown');
            notifDd.classList.add('hidden');
            dd.classList.toggle('hidden');
        }

        function closeAllDropdowns() {
            document.getElementById('notif-dropdown')?.classList.add('hidden');
            document.getElementById('profile-dropdown')?.classList.add('hidden');
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', (e) => {
            if (!document.getElementById('notif-bell-wrap')?.contains(e.target)) {
                document.getElementById('notif-dropdown')?.classList.add('hidden');
            }
            if (!document.getElementById('profile-wrap')?.contains(e.target)) {
                document.getElementById('profile-dropdown')?.classList.add('hidden');
            }
        });

        // ── Init greeting ─────────────────────────────────────────────────────────────
        function initGreeting(name) {
            const h = today.getHours();
            const g = h < 12 ? 'Good Morning' : h < 17 ? 'Good Afternoon' : 'Good Evening';
            document.getElementById('greetBadge').textContent = g;
            document.getElementById('greetText').textContent = `${g}, ${name ? name.split(' ')[0] : ''}`;
            document.getElementById('dateStr').textContent = today.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            const todayClasses = FACULTY_TT.filter(r => r.day === todayName).length;
            document.getElementById('todayClasses').textContent = `${todayName} — You have ${todayClasses} class${todayClasses !== 1 ? 'es' : ''} today`;
        }

        // ── Overview ──────────────────────────────────────────────────────────────────
        function renderOverview() {
            const total = COURSES.reduce((a, c) => a + c.students, 0);
            const stats = [
                { label: 'Courses Teaching', value: COURSES.length, grad: 'from-purple-600 to-purple-400', icon: 'M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z' },
                { label: 'Total Students', value: total, grad: 'from-cyan-600 to-cyan-400', icon: 'M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2M9 11a4 4 0 100-8 4 4 0 000 8z' },
                { label: "Today's Classes", value: 2, grad: 'from-pink-600 to-rose-400', icon: 'M8 2v4M16 2v4M3 10h18M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2z' },
                { label: 'Pending Deadlines', value: DEADLINES.length, grad: 'from-amber-600 to-amber-400', icon: 'M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0' },
            ];
            document.getElementById('statCards').innerHTML = stats.map(s => `
    <div class="bg-card border border-white/5 rounded-2xl p-5 group hover:border-accent/30 hover:shadow-glow transition-all duration-300 hover:-translate-y-1">
      <div class="w-10 h-10 rounded-xl bg-gradient-to-br ${s.grad} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-200 shadow-lg">
        <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="${s.icon}"/></svg>
      </div>
      <div class="font-display font-extrabold text-3xl text-white">${s.value}</div>
      <div class="text-xs text-purple-300/50 mt-1 font-medium">${s.label}</div>
    </div>
  `).join('');
        }

        // ── Courses ───────────────────────────────────────────────────────────────────
        function renderCourses() {
            const semColor = { 'Sem 3': 'bg-cyan/10 text-cyan border-cyan/20', 'Sem 5': 'bg-accent/10 text-accent3 border-accent/20' };
            setTimeout(() => {
                document.getElementById('coursesGrid').innerHTML = COURSES.map(c => `
      <div class="bg-card border border-white/5 rounded-2xl p-5 group hover:border-accent/30 hover:shadow-glow transition-all duration-300 hover:-translate-y-1 flex flex-col gap-3 relative overflow-hidden">
        <div class="absolute top-0 left-0 right-0 h-0.5 opacity-0 group-hover:opacity-100 transition-opacity duration-300" style="background:linear-gradient(to right,transparent,rgba(139,92,246,0.4),transparent)"></div>
        <div class="flex items-start justify-between">
          <span class="text-[10px] font-bold text-accent3 bg-accent/10 border border-accent/20 px-2.5 py-1 rounded-lg tracking-wide uppercase">${c.code}</span>
          <span class="text-[10px] font-semibold px-2.5 py-1 rounded-lg border ${semColor[c.semester] || 'bg-white/5 text-purple-300 border-white/10'}">${c.semester}</span>
        </div>
        <div>
          <h3 class="font-display font-bold text-white text-sm leading-snug mb-1">${c.name}</h3>
          <p class="text-[11px] text-purple-300/50">Section ${c.section}</p>
        </div>
        <div class="flex items-center gap-2 mt-auto">
          <div class="w-7 h-7 rounded-lg flex items-center justify-center" style="background:linear-gradient(135deg,rgba(124,58,237,0.3),rgba(236,72,153,0.2))">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="#A78BFA" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2M9 11a4 4 0 100-8 4 4 0 000 8z"/></svg>
          </div>
          <div>
            <div class="font-display font-bold text-white text-lg leading-none">${c.students}</div>
            <div class="text-[10px] text-purple-300/40">Students Enrolled</div>
          </div>
        </div>
        <button onclick="viewStudents(${c.id}, '${c.code} — ${c.name}')" class="w-full mt-1 py-2 bg-accent/10 hover:bg-gradient-to-r border border-accent/20 hover:border-transparent rounded-xl text-[13px] font-display font-semibold text-accent3 hover:text-white transition-all duration-200" style="font-family:Syne,sans-serif">View Students →</button>
      </div>
    `).join('');
            }, 600);
        }

        async function viewStudents(courseId, title) {
            document.getElementById('sModalTitle').textContent = 'Enrolled Students';
            document.getElementById('sModalSub').textContent = title;
            document.getElementById('sTableBody').innerHTML = '<tr><td colspan="7" class="text-center py-10">Loading students...</td></tr>';
            document.getElementById('studentsModal').classList.remove('hidden');

            try {
                const res = await fetch(`/api/faculty/course/${courseId}/students`, { credentials: 'include' });
                const json = await res.json();
                if (json.success) {
                    const students = json.data;
                    document.getElementById('sTableBody').innerHTML = students.length === 0
                        ? '<tr><td colspan="7" class="text-center py-10 text-purple-300/30">No students enrolled yet.</td></tr>'
                        : students.map(s => `
                            <tr>
                                <td class="font-bold text-accent3">${s.usn}</td>
                                <td class="text-white">${s.name}</td>
                                <td>Sem ${s.semester}</td>
                                <td class="font-mono">${s.marks.mse1}</td>
                                <td class="font-mono">${s.marks.mse2}</td>
                                <td class="font-mono">${s.marks.assignment1}</td>
                                <td class="font-mono">${s.marks.assignment2}</td>
                            </tr>
                        `).join('');
                }
            } catch (err) {
                console.error(err);
                document.getElementById('sTableBody').innerHTML = '<tr><td colspan="7" class="text-center py-10 text-red-400">Error loading data.</td></tr>';
            }
        }

        function closeStudentsModal() { document.getElementById('studentsModal').classList.add('hidden'); }

        function handleFileChange(input) {
            const fileName = input.files[0] ? input.files[0].name : 'Click to select file or drag and drop';
            document.getElementById('fNameText').textContent = fileName;
        }

        async function performFileUpload() {
            const fileInput = document.getElementById('fUpload');
            const subjectSelect = document.getElementById('uSubject');
            const semester = document.getElementById('uSemester').value;
            const unit = document.getElementById('uUnit').value;
            const btn = document.getElementById('uBtn');

            if (!fileInput.files[0]) return alert("Please select a file first");

            const selectedOption = subjectSelect.options[subjectSelect.selectedIndex];
            const subjectCode = selectedOption.getAttribute('data-code');

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);
            formData.append('subject_code', subjectCode);
            formData.append('semester', semester);
            formData.append('unit', unit);

            btn.disabled = true;
            btn.textContent = 'Uploading...';

            try {
                const res = await fetch('/api/faculty/upload-file', {
                    method: 'POST',
                    body: formData,
                    credentials: 'include'
                });
                const json = await res.json();
                if (json.success) {
                    btn.textContent = 'Uploaded Successfully!';
                    btn.style.background = 'linear-gradient(to right, #059669, #10b981)';
                    setTimeout(() => {
                        btn.textContent = 'Upload and Notify Students';
                        btn.style.background = 'linear-gradient(135deg,#7c3aed,#EC4899)';
                        btn.disabled = false;
                        fileInput.value = '';
                        document.getElementById('fNameText').textContent = 'Click to select file or drag and drop';
                    }, 2000);
                } else {
                    alert(json.detail || "Upload failed");
                    btn.disabled = false;
                    btn.textContent = 'Upload and Notify Students';
                }
            } catch (err) {
                console.error(err);
                alert("Server error during upload");
                btn.disabled = false;
                btn.textContent = 'Upload and Notify Students';
            }
        }

        // ── Faculty Timetable ─────────────────────────────────────────────────────────
        function renderFacultyTT() {
            document.getElementById('ftTodayLabel').textContent = 'Today: ' + todayName;
            const days = ['All', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
            document.getElementById('ftDayFilter').innerHTML = days.map(d => `
    <button onclick="setFtFilter('${d}',this)"
      class="px-3 py-1.5 rounded-lg text-[12px] font-medium transition-all duration-200 border ${ftFilter === d ? 'bg-accent/20 text-accent3 border-accent/40 shadow-glow' : 'bg-card2 text-purple-300/50 border-white/5 hover:border-accent/20 hover:text-purple-300'} ${d === todayName ? 'ring-1 ring-accent/40' : ''}">
      ${d}
    </button>
  `).join('');
            renderFtTable();
        }

        function setFtFilter(d, el) {
            ftFilter = d;
            document.querySelectorAll('#ftDayFilter button').forEach(b => {
                b.className = `px-3 py-1.5 rounded-lg text-[12px] font-medium transition-all duration-200 border bg-card2 text-purple-300/50 border-white/5 hover:border-accent/20 hover:text-purple-300 ${b.textContent.trim() === todayName ? 'ring-1 ring-accent/40' : ''}`;
            });
            el.className = `px-3 py-1.5 rounded-lg text-[12px] font-medium transition-all duration-200 border bg-accent/20 text-accent3 border-accent/40 shadow-glow ${d === todayName ? 'ring-1 ring-accent/40' : ''}`;
            renderFtTable();
        }

        function renderFtTable() {
            const rows = ftFilter === 'All' ? FACULTY_TT : FACULTY_TT.filter(r => r.day === ftFilter);
            document.getElementById('ftTableBody').innerHTML = rows.length === 0
                ? `<tr><td colspan="5" class="text-center py-10 text-purple-300/30">No classes on this day</td></tr>`
                : rows.map(r => `
      <tr class="${r.day === todayName ? 'today-row' : ''}">
        <td><div class="flex items-center gap-2">${r.day === todayName ? '<span class="w-1.5 h-1.5 rounded-full bg-accent flex-shrink-0"></span>' : ''}<span class="${r.day === todayName ? 'text-accent3 font-semibold' : ''}">${r.day}</span></div></td>
        <td class="font-mono text-[12px]">${r.time}</td>
        <td><span class="font-medium text-white/80">${r.course}</span></td>
        <td><span class="px-2 py-0.5 rounded-md border text-[11px]" style="background:rgba(6,182,212,0.08);color:#06B6D4;border-color:rgba(6,182,212,0.15)">${r.classroom}</span></td>
        <td><span class="px-2 py-0.5 rounded-md border text-[11px]" style="background:rgba(139,92,246,0.08);color:#A78BFA;border-color:rgba(139,92,246,0.15)">${r.semester}</span></td>
      </tr>`).join('');
        }

        // ── Student Timetable ─────────────────────────────────────────────────────────
        function renderStudentTT() {
            const sems = Object.keys(STUDENT_TT);
            document.getElementById('stSemBtns').innerHTML = sems.map(s => `
    <button onclick="setStSem('${s}',this)" class="px-4 py-2 rounded-xl text-[12px] font-medium border transition-all duration-200 ${stSem === s ? 'bg-accent/20 text-accent3 border-accent/40 shadow-glow' : 'bg-card2 text-purple-300/50 border-white/5 hover:border-accent/20'}">${s}</button>
  `).join('');
            renderStSecBtns();
            renderStTable();
        }

        function setStSem(s, el) {
            stSem = s;
            const secs = Object.keys(STUDENT_TT[s]);
            stSec = secs[0];
            document.querySelectorAll('#stSemBtns button').forEach(b => b.className = 'px-4 py-2 rounded-xl text-[12px] font-medium border transition-all duration-200 bg-card2 text-purple-300/50 border-white/5 hover:border-accent/20');
            el.className = 'px-4 py-2 rounded-xl text-[12px] font-medium border transition-all duration-200 bg-accent/20 text-accent3 border-accent/40 shadow-glow';
            renderStSecBtns();
            renderStTable();
        }

        function renderStSecBtns() {
            const secs = Object.keys(STUDENT_TT[stSem] || {});
            document.getElementById('stSecBtns').innerHTML = secs.map(sec => `
    <button onclick="setStSec('${sec}',this)" class="px-4 py-2 rounded-xl text-[12px] font-medium border transition-all duration-200 ${stSec === sec ? 'bg-pink/20 text-pink border-pink/40' : 'bg-card2 text-purple-300/50 border-white/5 hover:border-pink/20'}">Section ${sec}</button>
  `).join('');
        }

        function setStSec(sec, el) {
            stSec = sec;
            document.querySelectorAll('#stSecBtns button').forEach(b => b.className = 'px-4 py-2 rounded-xl text-[12px] font-medium border transition-all duration-200 bg-card2 text-purple-300/50 border-white/5 hover:border-pink/20');
            el.className = 'px-4 py-2 rounded-xl text-[12px] font-medium border transition-all duration-200 bg-pink/20 text-pink border-pink/40';
            renderStTable();
        }

        function renderStTable() {
            const rows = STUDENT_TT[stSem]?.[stSec] || [];
            document.getElementById('stTableTitle').textContent = `${stSem} — Section ${stSec}`;
            document.getElementById('stTableCount').textContent = `${rows.length} classes/week`;
            document.getElementById('stTableBody').innerHTML = rows.length === 0
                ? `<tr><td colspan="5" class="text-center py-10 text-purple-300/30">No timetable available</td></tr>`
                : rows.map(r => `
      <tr class="${r.day === todayName ? 'today-row' : ''}">
        <td><div class="flex items-center gap-2">${r.day === todayName ? '<span class="w-1.5 h-1.5 rounded-full bg-accent flex-shrink-0"></span>' : ''}<span class="${r.day === todayName ? 'text-accent3 font-semibold' : ''}">${r.day}</span></div></td>
        <td class="font-mono text-[12px]">${r.time}</td>
        <td><span class="text-white/80 font-medium">${r.subject}</span></td>
        <td class="text-purple-300/60 text-[12px]">${r.faculty}</td>
        <td><span class="px-2 py-0.5 rounded-md border text-[11px]" style="background:rgba(6,182,212,0.08);color:#06B6D4;border-color:rgba(6,182,212,0.15)">${r.room}</span></td>
      </tr>`).join('');
        }

        // ── Strength ──────────────────────────────────────────────────────────────────
        function renderStrength() {
            // Bar chart
            const maxVal = Math.max(...STRENGTH.map(d => d.total));
            const chartH = 180;
            document.getElementById('barChart').innerHTML = `
    <div class="chart-y-axis text-right pr-2" style="height:${chartH + 20}px">
      ${[maxVal, Math.round(maxVal * 0.75), Math.round(maxVal * 0.5), Math.round(maxVal * 0.25), 0].map(v => `<div class="chart-y-label">${v}</div>`).join('')}
    </div>
    <div class="flex-1 flex items-end gap-4 pb-5" style="height:${chartH + 20}px;border-left:1px solid rgba(139,92,246,0.1);border-bottom:1px solid rgba(139,92,246,0.1)">
      ${STRENGTH.map(d => {
                const mH = Math.round((d.male / maxVal) * chartH);
                const fH = Math.round((d.female / maxVal) * chartH);
                return `
          <div class="bar-group">
            <div class="bar-inner">
              <div class="bar bg-accent" style="height:${mH}px" title="Male: ${d.male}"></div>
              <div class="bar bg-pink" style="height:${fH}px" title="Female: ${d.female}"></div>
            </div>
            <div class="bar-label">${d.name}</div>
          </div>`;
            }).join('')}
    </div>
  `;
            // Cards
            setTimeout(() => {
                document.getElementById('strengthCards').innerHTML = STRENGTH.map(d => {
                    const mp = Math.round((d.male / d.total) * 100);
                    const fp = 100 - mp;
                    return `
        <div class="bg-card border border-white/5 rounded-2xl p-5 hover:border-accent/30 hover:shadow-glow transition-all duration-300 hover:-translate-y-0.5">
          <div class="flex items-center justify-between mb-3">
            <span class="text-[10px] font-bold text-accent3 bg-accent/10 border border-accent/20 px-2 py-0.5 rounded-md">${d.name}</span>
            <span class="font-display font-extrabold text-white text-xl">${d.total}</span>
          </div>
          <p class="text-[12px] text-purple-300/60 mb-3 font-medium">${d.full}</p>
          <div class="h-2 rounded-full overflow-hidden flex mb-2" style="background:#181828">
            <div class="h-full rounded-l-full transition-all duration-700 bg-accent" style="width:${mp}%"></div>
            <div class="h-full rounded-r-full transition-all duration-700 bg-pink" style="width:${fp}%"></div>
          </div>
          <div class="flex justify-between text-[11px]">
            <span class="text-accent3">Male: ${d.male} (${mp}%)</span>
            <span class="text-pink">Female: ${d.female} (${fp}%)</span>
          </div>
        </div>`;
                }).join('');
            }, 600);
        }

        // ── Notifications ─────────────────────────────────────────────────────────────
        const priorityStyle = {
            High: 'bg-red-500/10 text-red-400 border-red-500/25',
            Medium: 'bg-amber-500/10 text-amber-400 border-amber-500/25',
            Low: 'bg-emerald-500/10 text-emerald-400 border-emerald-500/25',
        };
        const priorityDot = { High: 'bg-red-400', Medium: 'bg-amber-400', Low: 'bg-emerald-400' };

        function renderNotifs() {
            const items = NOTIFS[activeNotifTab] || [];
            document.getElementById('hodCount').textContent = NOTIFS.hod.length;
            document.getElementById('sentCount').textContent = NOTIFS.sent.length;
            document.getElementById('notifList').innerHTML = items.length === 0
                ? `<div class="text-center py-16 text-purple-300/30 text-sm">No notifications</div>`
                : items.map(n => `
      <div class="bg-card2 border border-white/5 rounded-xl p-4 hover:border-accent/25 transition-all duration-200 group">
        <div class="flex items-start justify-between gap-3 mb-2">
          <div class="flex items-center gap-2">
            <h4 class="font-display font-semibold text-white text-[13px] leading-snug group-hover:text-accent3 transition-colors">${n.title}</h4>
            ${n.is_new ? '<span class="text-[8px] font-black bg-cyan-500/20 text-cyan-400 px-1.5 py-0.5 rounded uppercase tracking-widest border border-cyan-500/30">New+</span>' : ''}
          </div>
          <span class="text-[10px] font-bold px-2 py-0.5 rounded-full border flex-shrink-0 ${priorityStyle[n.priority]}">
            <span class="inline-block w-1.5 h-1.5 rounded-full mr-1 ${priorityDot[n.priority]}"></span>${n.priority}
          </span>
        </div>
        <p class="text-[12px] text-purple-300/55 leading-relaxed mb-3">${n.message}</p>
        <div class="flex items-center gap-1.5 text-[11px] text-purple-400/35">
          <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 2v4M16 2v4M3 10h18M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2z"/></svg>
          ${n.timestamp}
        </div>
      </div>`).join('');
        }

        function switchNotifTab(tab, el) {
            activeNotifTab = tab;
            document.querySelectorAll('.notif-tab').forEach(b => b.className = 'notif-tab flex items-center gap-2 px-4 py-2.5 rounded-xl border text-[13px] font-medium transition-all duration-200 bg-card2 border-white/5 text-purple-300/50 hover:border-accent/20 hover:text-purple-300');
            el.className = 'notif-tab flex items-center gap-2 px-4 py-2.5 rounded-xl border text-[13px] font-medium transition-all duration-200 bg-accent/15 border-accent/40 text-accent3 shadow-glow';
            renderNotifs();
        }

        function openNotifModal() { document.getElementById('notifModal').classList.remove('hidden'); }
        function closeNotifModal() { document.getElementById('notifModal').classList.add('hidden'); }

        async function sendNotification() {
            const title = document.getElementById('nTitle').value.trim();
            const message = document.getElementById('nMessage').value.trim();
            const priority = document.getElementById('nPriority').value;
            if (!title || !message) return;

            try {
                const res = await fetch('/api/faculty/notifications', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({ title, message, priority })
                });

                if (res.ok) {
                    const btn = document.querySelector('button[onclick="sendNotification()"]');
                    const oldText = btn.textContent;
                    btn.textContent = 'Sent Successfully!';
                    btn.style.background = 'linear-gradient(to right, #059669, #10b981)';

                    setTimeout(() => {
                        document.getElementById('nTitle').value = '';
                        document.getElementById('nMessage').value = '';
                        btn.textContent = oldText;
                        btn.style.background = 'linear-gradient(135deg,#7c3aed,#EC4899)';
                        closeNotifModal();
                    }, 1000);

                    // Refresh data to show new notification in "Sent" tab
                    await loadDashboardData();

                    activeNotifTab = 'sent';
                    renderNotifs();

                    // Update tab styling
                    document.querySelectorAll('.notif-tab').forEach((b, i) => {
                        if (i === 1) b.className = 'notif-tab flex items-center gap-2 px-4 py-2.5 rounded-xl border text-[13px] font-medium transition-all duration-200 bg-accent/15 border-accent/40 text-accent3 shadow-glow';
                        else b.className = 'notif-tab flex items-center gap-2 px-4 py-2.5 rounded-xl border text-[13px] font-medium transition-all duration-200 bg-card2 border-white/5 text-purple-300/50 hover:border-accent/20 hover:text-purple-300';
                    });
                }
            } catch (err) {
                console.error("Failed to send notification:", err);
                alert("Failed to send notification. Check server logs.");
            }
        }

        // ── Calendar ──────────────────────────────────────────────────────────────────
        function getDeadlineMap() {
            return DEADLINES.reduce((acc, d) => { acc[d.date] = [...(acc[d.date] || []), d]; return acc; }, {});
        }

        function pad(n) { return String(n).padStart(2, '0'); }
        function dateKey(y, m, d) { return `${y}-${pad(m + 1)}-${pad(d)}`; }

        function renderCalendar() {
            const y = calViewDate.getFullYear();
            const m = calViewDate.getMonth();
            const fd = new Date(y, m, 1).getDay();
            const dim = new Date(y, m + 1, 0).getDate();
            const dm = getDeadlineMap();

            document.getElementById('calMonthLabel').textContent = `${MONTHS[m]} ${y}`;

            let html = '';
            for (let i = 0; i < fd; i++) html += '<div></div>';
            for (let d = 1; d <= dim; d++) {
                const isToday = d === today.getDate() && m === today.getMonth() && y === today.getFullYear();
                const hasDl = !!dm[dateKey(y, m, d)];
                const isSel = calSelected === d;
                html += `<div class="cal-day ${isToday ? 'today' : ''} ${hasDl ? 'has-dl' : ''} ${isSel && !isToday ? 'selected' : ''}" onclick="selectCalDay(${d})">${d}</div>`;
            }
            document.getElementById('calGrid').innerHTML = html;
        }

        function selectCalDay(d) {
            calSelected = calSelected === d ? null : d;
            renderCalendar();
            renderDlPanel();
        }

        function changeMonth(dir) {
            calViewDate = new Date(calViewDate.getFullYear(), calViewDate.getMonth() + dir, 1);
            calSelected = null;
            renderCalendar();
            renderDlPanel();
        }

        function renderDlPanel() {
            const y = calViewDate.getFullYear();
            const m = calViewDate.getMonth();
            const titleEl = document.getElementById('dlPanelTitle');
            const panelEl = document.getElementById('dlPanel');

            if (!calSelected) {
                titleEl.textContent = 'Select a date to view deadlines';
                panelEl.innerHTML = `<div class="flex flex-col items-center justify-center h-52 text-purple-300/25 gap-3"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 2v4M16 2v4M3 10h18M5 4h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2z"/></svg><span class="text-sm">Click a date with a pink dot</span></div>`;
                return;
            }
            const key = dateKey(y, m, calSelected);
            const items = getDeadlineMap()[key] || [];
            titleEl.textContent = `Deadlines — ${MONTHS[m]} ${calSelected}, ${y}`;
            panelEl.innerHTML = items.length === 0
                ? `<div class="flex flex-col items-center justify-center h-52 text-purple-300/25 gap-3"><svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6L9 17l-5-5"/></svg><span class="text-sm">No deadlines on this date</span></div>`
                : `<div class="flex flex-col gap-3">${items.map(dl => `
        <div class="bg-card2 border border-white/5 rounded-xl p-4 group hover:border-accent/20 transition-all" style="border-left:2px solid #EC4899">
          <div class="flex items-start justify-between gap-2 mb-1">
            <h4 class="font-display font-bold text-white text-[13px]">${dl.title}</h4>
            <div class="flex gap-1.5 opacity-0 group-hover:opacity-100 transition-opacity">
              <button onclick="openEditModal(${dl.id})" class="w-7 h-7 rounded-lg flex items-center justify-center text-accent3 hover:bg-accent/20 transition-all" style="background:rgba(139,92,246,0.1);border:1px solid rgba(139,92,246,0.2)">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
              </button>
              <button onclick="deleteDl(${dl.id})" class="w-7 h-7 rounded-lg flex items-center justify-center text-red-400 hover:bg-red-500/20 transition-all" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.2)">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18M8 6V4h8v2M19 6l-1 14H6L5 6"/></svg>
              </button>
            </div>
          </div>
          <div class="text-[11px] text-purple-300/40 mb-2">${dl.course} · Due: ${dl.time}</div>
          ${dl.description ? `<p class="text-[12px] text-purple-300/60 leading-relaxed">${dl.description}</p>` : ''}
        </div>`).join('')}
      </div>`;
        }

        function openAddModal() {
            dlEditId = null;
            document.getElementById('dlModalTitle').textContent = 'Add Deadline';
            document.getElementById('dlSaveBtn').textContent = 'Add Deadline';
            document.getElementById('dlTitle').value = '';
            document.getElementById('dlDesc').value = '';
            document.getElementById('dlDate').value = '';
            document.getElementById('dlTime').value = '';
            document.getElementById('dlModal').classList.remove('hidden');
        }

        function openEditModal(id) {
            const dl = DEADLINES.find(d => d.id === id);
            if (!dl) return;
            dlEditId = id;
            document.getElementById('dlModalTitle').textContent = 'Edit Deadline';
            document.getElementById('dlSaveBtn').textContent = 'Save Changes';
            document.getElementById('dlCourse').value = dl.course;
            document.getElementById('dlTitle').value = dl.title;
            document.getElementById('dlDesc').value = dl.description;
            document.getElementById('dlDate').value = dl.date;
            document.getElementById('dlTime').value = dl.time;
            document.getElementById('dlModal').classList.remove('hidden');
        }

        function closeDlModal() { document.getElementById('dlModal').classList.add('hidden'); dlEditId = null; }

        async function saveDl() {
            const title = document.getElementById('dlTitle').value.trim();
            const date = document.getElementById('dlDate').value;
            const time = document.getElementById('dlTime').value;
            const course_id = document.getElementById('dlCourse').value;
            const description = document.getElementById('dlDesc').value.trim();

            if (!title || !date) return;

            const full_due = `${date} ${time || "00:00"}`;

            try {
                const res = await fetch('/api/faculty/assignments', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({
                        course_id: parseInt(course_id),
                        title,
                        description,
                        due_date: full_due
                    })
                });

                if (res.ok) {
                    const btn = document.getElementById('dlSaveBtn');
                    const oldText = btn.textContent;
                    btn.textContent = 'Success!';
                    btn.style.background = 'linear-gradient(to right, #059669, #10b981)';

                    setTimeout(() => {
                        btn.textContent = oldText;
                        btn.style.background = 'linear-gradient(135deg,#7c3aed,#EC4899)';
                        closeDlModal();
                    }, 1000);

                    await loadDashboardData();
                    renderCalendar();
                    renderDlPanel();
                }
            } catch (err) {
                console.error("Failed to add assignment:", err);
            }
        }

        function deleteDl(id) {
            DEADLINES = DEADLINES.filter(d => d.id !== id);
            renderCalendar();
            renderDlPanel();
        }

        // ── Boot ──────────────────────────────────────────────────────────────────────
        document.addEventListener('DOMContentLoaded', loadDashboardData);
        // Fallback: if DOMContentLoaded already fired (script is defer-less)
        if (document.readyState !== 'loading') loadDashboardData();
    </script>
</body>

</html>